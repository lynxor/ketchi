<div class="lift:surround?with=default&at=content">
    <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
    <div>
        <h1>Create a new ad</h1>
    </div>
    <div>
        <script>
            var map = null;

            //Initialise the datepicker
            $(function() {
                var dates = $( "#fromDate, #toDate" ).datepicker({
                    defaultDate: "+1w",
                    changeMonth: true,
                    numberOfMonths: 3,
                    dateFormat: "yy/mm/dd",
                    onSelect: function( selectedDate ) {
                        var option = this.id == "fromDate" ? "minDate" : "maxDate",
                        instance = $( this ).data( "datepicker" );
                        date = $.datepicker.parseDate(
                        instance.settings.dateFormat ||
                            $.datepicker._defaults.dateFormat,
                        selectedDate, instance.settings );
                        dates.not( this ).datepicker( "option", option, date );
                    }
                });
            });

            //initialise the tabs
            $(function() {
                $( "#tabs" ).tabs({
                    show: function(event, ui){
                        var selected = $( "#tabs" ).tabs( "option", "selected" );
                        if(selected == 1){
                            google.maps.event.trigger(map, 'resize');
                            map.setCenter(new google.maps.LatLng(-26.195308, 28.043861));
                        }
                    }
                });

               
            });
            function initMaps(){
                var latlng = new google.maps.LatLng(-26.195308, 28.043861);
                var myOptions = {
                    zoom: 8,
                    center: latlng,
                    mapTypeId: google.maps.MapTypeId.ROADMAP
                };
                map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);

                google.maps.event.addListener(map, 'click', function(event) {
                    $("#the_lat").val(event.latLng.lat());
                    $("#the_long").val(event.latLng.lng());
                    //placeMarker(event.latLng)
                });


            }

            $("#map_canvas").ready(function(){               
                initMaps()
            })
          
            $(document).ready(function(){
                $("input:radio").click(function(){
                    selected_radio = $("input:radio:checked").attr("value")
                    $("#image_input").val(selected_radio);
                })
                
                $("#address_search_dialogue").dialog({
                    autoOpen: false,
                    modal: true,
                    width: 465,
                    height: 300
                })
            })
            
        </script>

        <form class="lift:CreateGenericAd?form=post">

            <div id="tabs">
                <ul>
                    <li><a href="#general" >General Information</a></li>               
                    <li><a href="#location" >Location</a></li>
                    <li><a href="#time" >Time Frame</a></li>
                    <li><a href="#images" >Image</a></li>
                    <li><a href="#tags">Tags</a></li>
                </ul>
                <div id="general">
                    <table>
                        <tr><td>Header:</td> <td><input name="header" id="the_header" ></td></tr>
                        <tr> <td>Content:</td><td> <input name="content" id="the_content" ></td></tr>
                        <tr> <td>Contact details:</td><td> <input name="contacts" id="the_contacts"></td></tr>
                        <tr> <td>Link to your website: </td><td><input name="link" id="the_link"></td></tr>
                        <tr> <td>Contact email: </td><td><input name="email" id="the_email"></td></tr>
                    </table>
                </div>
                <div id="location">
                    <div id="map_canvas" style="height: 400px; width:580px"></div>
                    <div style="padding: 10px">
                        Lat: <input name="lat" id="the_lat">
                        Long: <input name="long" id="the_long" style="padding-left: 5px"><br>
                    </div>

                    <div id="address_search_dialogue" title="Find address" >
                        <div class="lift:GeoCodingSnippet.locationFromNameSetLatLong" >
                            <div style="padding: 15px">
                                Address <input id="address" ><br>
                                Province <input id="province"></br>
                                <input id="geocode_button" 
                                       class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only"
                                       style="padding: 3px"
                                       onmouseover="hover(this)"
                                       onmouseout="unhover(this)"/>
                            </div>
                            <div id="addressesFound" ></div>
                        </div>

                    </div>
                    <input class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only"
                           style="padding: 3px"
                           type="button" 
                           onclick="$('#address_search_dialogue').dialog('open')" 
                           value="Find address"
                           onmouseover="hover(this)"
                           onmouseout="unhover(this)"/>

                    <!--                    <button class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only"
                                                style="float: right"
                                                role="button"
                                                area-disabled="false"
                                                onmouseover="hover(this)"
                                                onmouseout="unhover(this)"
                                                onclick="$('#address_search_dialogue').dialog('open');">
                                            <span class="ui-button-text">Find by location name</span>
                                        </button>-->
                </div>


                <div id="time">
                    From date: <input name="startDate" id="fromDate">
                    to <input name="endDate" id="toDate"><br>
                </div>

                <div style="height:300px; overflow-y: auto;" id="images">
                    <input type="hidden" name="imageId" id="image_input" >
                    <table class="lift:ImageListing.asSelectTable">

                        <tr id="select_rows"><td></td></tr>
                        <!--                        <tr><td/><td><input type="button" id="deleteImage" ></td></tr>

                                                <tr><td/><td><input type="button" id="uploadImage"></td></tr>-->
                    </table>
                    <input id="create_ad_button" value="Save" type="submit" >
                </div>
                <div id="tags">
                    <div>
                        <span >This should be a comma separated list of items</span>
                    </div>

                    <div>
                        Tags: <input name="tags" />
                    </div>

                    <div class="pleasenote">
                        <span style="font-weight: bold"> It is important to fill this in with care as it will be used for searches</span>
                    </div>
                </div>
        </form>

    </div>
</div>


