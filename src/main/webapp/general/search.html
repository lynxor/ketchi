<div id="main" class="lift:surround?with=default&at=content">
    <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
    <div>
        <h2>Search</h2>
    </div>
    <script type="text/javascript" >
   var theCircle;
        function initSearchMaps(){
         
            var latlng = new google.maps.LatLng(-26.195308, 28.043861);
            var myOptions = {
                zoom: 8,
                center: latlng,
                mapTypeId: google.maps.MapTypeId.ROADMAP
            };
            var searchMap = new google.maps.Map(document.getElementById("search_map"), myOptions);

            google.maps.event.addListener(searchMap, 'click', function(event) {

                $("#the_lat").val(event.latLng.lat());
                $("#the_long").val(event.latLng.lng());
 //alert("creating circle!!!!!!!!!");
                 theCircle = new google.maps.Circle({
                   
                    center:event.latLng,
                    map: searchMap,
                    radius: 10000
                    
                });
                
                //placeMarker(event.latLng)
            });
        }

        $("#search_map").ready(function(){
            initSearchMaps()
        })

        $(function() {
            $( "#max_distance" ).slider({
                min: 0,
                max: 10,
                step: 0.1,
                slide: function( event, ui ) {
                    $( "#max_distance_input" ).val(ui.value);
                    theCircle.setRadius(number(ui.value));
                }

            });

             $(".statsLink").click(function(){
                alert("clicked a stats link");
             });
        });


    </script>
    <form class="lift:form.ajax">
        <div class="lift:Search">
            <div id="search_map" style="height: 400px; width:600px"></div>
            <div id="max_distance" ></div>
            <input type="hidden" id="max_distance_input" >
            <table>
                <tr><td>Location</td> 
                    <td>
                        <span class="lift:Msg?id=latErr&errorClass=error">error</span><input name="lat" id="the_lat" value="0">
                        <span class="lift:Msg?id=longErr&errorClass=error">error</span><input name="long" id="the_long" value="0">
                    </td>
                </tr>              
                <tr><td>Category </td> <td><input name="categories" /></td></tr>
                <tr><td/><td><input value="Search" type="submit"></td></tr>
            </table>
        </div>
    </form>

    <div name="searchResults" id="search_results">No results</div>
</div>